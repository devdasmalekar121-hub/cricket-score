<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Cricket Scoreboard PRO</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --p1: #00e5ff; --p2: #ff0040; --bg: #000814; --card: #00122e; }
        body { margin: 0; background: var(--bg); font-family: 'Roboto', sans-serif; color: white; display: flex; flex-direction: column; align-items: center; }
        
        .master-container { width: 100%; max-width: 500px; background: var(--card); overflow: hidden; position: relative; transition: 0.3s; }
        
        /* Animation Flash Styles */
        @keyframes flash-yellow { 0% { background: var(--card); } 50% { background: #fec309; } 100% { background: var(--card); } }
        @keyframes flash-red { 0% { background: var(--card); } 50% { background: #ff0040; } 100% { background: var(--card); } }
        .animate-four-six { animation: flash-yellow 0.5s ease 3; }
        .animate-wicket { animation: flash-red 0.5s ease 3; }

        .top-status-bar { display: flex; height: 6px; width: 100%; }
        #win-p1 { background: var(--p1); width: 50%; transition: 1s; }
        #win-p2 { background: var(--p2); width: 50%; transition: 1s; }

        .main-board { padding: 15px; }
        .score-row { display: flex; justify-content: space-between; align-items: center; }
        .runs { font-family: 'Orbitron'; font-size: 55px; color: var(--p1); text-shadow: 0 0 15px rgba(0,229,255,0.4); }
        .overs { font-size: 20px; opacity: 0.8; }
        
        .projected-capsule { background: rgba(255,255,255,0.1); padding: 4px 12px; border-radius: 20px; font-size: 12px; display: inline-block; margin-top: 5px; border: 1px solid rgba(255,255,255,0.2); }

        .player-box { margin-top: 15px; background: rgba(0,0,0,0.3); border-radius: 10px; padding: 10px; }
        .b-row { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .active-bat { color: var(--p1); font-weight: bold; }
        .active-bat::after { content: ' *'; }

        .dots-row { display: flex; gap: 5px; margin-top: 10px; justify-content: center; }
        .b-dot { width: 10px; height: 10px; border-radius: 50%; background: #333; }
        .b-dot.active { background: var(--p1); box-shadow: 0 0 8px var(--p1); }

        .admin-area { width: 93%; max-width: 400px; padding: 20px; margin-top: 20px; background: #111; border-radius: 15px; }
        .hidden { display: none !important; }
        .btn-group { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-top: 15px; }
        button { padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; color: white; transition: 0.2s; }
        .btn-run { background: #1a73e8; }
        .btn-action { background: #34a853; }
        .btn-danger { background: #ea4335; }
        .btn-dark { background: #333; }
        button:active { transform: scale(0.95); }
        input { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #333; background: #222; color: white; margin-bottom: 10px; box-sizing: border-box; }
        #d-equation { font-size: 13px; color: #fec309; text-align: center; margin-top: 10px; font-weight: bold; }
    </style>
</head>
<body onload="initApp()">

    <div class="master-container" id="scoreboard-card">
        <div class="top-status-bar">
            <div id="win-p1"></div>
            <div id="win-p2"></div>
        </div>

        <div class="main-board">
            <div style="font-size: 14px; opacity: 0.7; margin-bottom: 5px;" id="d-tour">TOURNAMENT</div>
            <div class="score-row">
                <div>
                    <span id="d-team" style="font-weight: bold; font-size: 22px;">TEAM</span>
                    <div class="runs"><span id="d-runs">0</span>/<span id="d-wkt">0</span></div>
                    <div id="proj-container" class="projected-capsule">PROJECTED: 0</div>
                </div>
                <div class="overs">OV: <span id="d-ov">0.0</span></div>
            </div>

            <div class="player-box">
                <div class="b-row" id="p1-row">
                    <span id="d-b1">Player 1</span><span id="d-b1-r">0(0)</span>
                </div>
                <div class="b-row" id="p2-row">
                    <span id="d-b2">Player 2</span><span id="d-b2-r">0(0)</span>
                </div>
                <div class="b-row" style="border:none; margin-top:5px; opacity:0.9;">
                    <span>BOWLER: <span id="d-bowl">---</span></span>
                    <span>TGT: <span id="d-target">0</span></span>
                </div>
            </div>

            <div class="dots-row" id="dots-container">
                <div class="b-dot"></div><div class="b-dot"></div><div class="b-dot"></div>
                <div class="b-dot"></div><div class="b-dot"></div><div class="b-dot"></div>
            </div>
            <div id="d-equation"></div>
        </div>
    </div>

    <div class="admin-area">
        <div id="login-area">
            <input type="password" id="pass-input" placeholder="Enter Admin PIN">
            <button class="btn-run" style="width:100%" onclick="checkAuth()">UNLOCK PANEL</button>
        </div>

        <div id="admin-panel" class="hidden">
            <button class="btn-danger" style="width:100%; margin-bottom:10px;" onclick="lockPanel()">LOCK PANEL</button>
            <input type="text" id="inp-t1" placeholder="Team Name">
            <input type="text" id="inp-tour" placeholder="Tournament Name">
            <div class="btn-group">
                <button class="btn-run" onclick="addRun(0)">0</button>
                <button class="btn-run" onclick="addRun(1)">1</button>
                <button class="btn-run" onclick="addRun(2)">2</button>
                <button class="btn-run" onclick="addRun(3)">3</button>
                <button class="btn-run" onclick="addRun(4)">4</button>
                <button class="btn-run" onclick="addRun(6)">6</button>
                <button class="btn-action" onclick="addRun(1, 'WD')">WD</button>
                <button class="btn-action" onclick="addRun(1, 'NB')">NB</button>
            </div>
            <div class="btn-group">
                <button class="btn-danger" onclick="outPlayer()">WICKET</button>
                <button class="btn-dark" onclick="undo()">UNDO</button>
                <button class="btn-action" onclick="newInning()">NEW INN</button>
            </div>
        </div>
    </div>

    <script>
        // FIREBASE CONFIG (अपनी डिटेल्स यहाँ डालें)
        const firebaseConfig = {
            databaseURL: "https://cricket-live-69f88-default-rtdb.firebaseio.com/"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database().ref('live_match');

        let state = { r:0, w:0, o:0, b:0, t1:'TEAM', tour:'MATCH', p1:{n:'P1',r:0,b:0}, p2:{n:'P2',r:0,b:0}, bowl:'BOWL', s:1, target:0, inn:1, anim:'' };
        let history = [];

        function initApp() {
            db.on('value', (snap) => {
                state = snap.val() || state;
                updateUI();
            });

            // Check if already logged in
            if(localStorage.getItem("admin_login") === "true") {
                showAdmin();
            }

            // Enter key for login
            document.getElementById("pass-input").addEventListener("keypress", (e) => {
                if (e.key === "Enter") checkAuth();
            });
        }

        function checkAuth() {
            if(document.getElementById('pass-input').value === "ChhotuLive8718") {
                localStorage.setItem("admin_login", "true");
                showAdmin();
            } else {
                alert("Wrong Pin!");
            }
        }

        function showAdmin() {
            document.getElementById('admin-panel').classList.remove('hidden');
            document.getElementById('login-area').classList.add('hidden');
        }

        function lockPanel() {
            localStorage.removeItem("admin_login");
            document.getElementById('admin-panel').classList.add('hidden');
            document.getElementById('login-area').classList.remove('hidden');
        }

        function updateUI() {
            const card = document.getElementById('scoreboard-card');
            
            // Runs, Wickets, Overs
            document.getElementById('d-runs').innerText = state.r;
            document.getElementById('d-wkt').innerText = state.w;
            document.getElementById('d-ov').innerText = `${state.o}.${state.b}`;
            document.getElementById('d-team').innerText = state.t1.toUpperCase();
            document.getElementById('d-tour').innerText = state.tour.toUpperCase();
            
            // Players
            document.getElementById('d-b1').innerText = state.p1.n;
            document.getElementById('d-b1-r').innerText = `${state.p1.r}(${state.p1.b})`;
            document.getElementById('d-b2').innerText = state.p2.n;
            document.getElementById('d-b2-r').innerText = `${state.p2.r}(${state.p2.b})`;
            document.getElementById('d-bowl').innerText = state.bowl;
            document.getElementById('d-target').innerText = state.target;

            // Striker Highlight
            document.getElementById('p1-row').className = state.s === 1 ? "b-row active-bat" : "b-row";
            document.getElementById('p2-row').className = state.s === 2 ? "b-row active-bat" : "b-row";

            // Projected Score & Win Bar
            let totalBalls = (state.o * 6) + state.b;
            let winP1 = 50;

            if (state.inn === 1 && totalBalls > 0) {
                let prj = Math.round((state.r / totalBalls) * 120);
                document.getElementById('d-proj').innerText = "PROJECTED: " + prj;
                document.getElementById('proj-container').style.display = "block";
                winP1 = Math.min(85, Math.max(15, (state.r / 2) - (state.w * 5)));
            } else if (state.inn === 2) {
                document.getElementById('proj-container').style.display = "none";
                let rem = state.target - state.r;
                let bLeft = 120 - totalBalls;
                if(bLeft > 0 && rem > 0) {
                    let rrr = (rem / (bLeft / 6)).toFixed(1);
                    document.getElementById('d-equation').innerText = `${rem} RUNS NEEDED IN ${bLeft} BALLS (RRR: ${rrr})`;
                    winP1 = Math.min(95, Math.max(5, (state.r / state.target) * 100));
                } else if(rem <= 0) {
                    document.getElementById('d-equation').innerText = "MATCH FINISHED!";
                    winP1 = 100;
                }
            }
            document.getElementById('win-p1').style.width = winP1 + "%";
            document.getElementById('win-p2').style.width = (100 - winP1) + "%";

            // Flash Animations
            card.classList.remove('animate-four-six', 'animate-wicket');
            if(state.anim === "FOUR" || state.anim === "SIX") card.classList.add('animate-four-six');
            if(state.anim === "WICKET") card.classList.add('animate-wicket');

            // Dots
            const dots = document.querySelectorAll('.b-dot');
            dots.forEach((d, i) => d.className = i < state.b ? "b-dot active" : "b-dot");
        }

        function addRun(v, type) {
            history.push(JSON.parse(JSON.stringify(state)));
            if(type === 'WD' || type === 'NB') {
                state.r += v;
            } else {
                state.r += v;
                state.b++;
                if(state.s === 1) { state.p1.r += v; state.p1.b++; }
                else { state.p2.r += v; state.p2.b++; }
                
                if(v === 4) state.anim = "FOUR";
                else if(v === 6) state.anim = "SIX";
                else state.anim = "";

                if(v % 2 !== 0) state.s = state.s === 1 ? 2 : 1;
                if(state.b === 6) { state.o++; state.b = 0; state.s = state.s === 1 ? 2 : 1; }
            }
            pushData();
            if(v === 4 || v === 6) setTimeout(() => { state.anim = ""; pushData(); }, 3000);
        }

        function outPlayer() {
            let n = prompt("Next Batsman Name:");
            if(n) {
                history.push(JSON.parse(JSON.stringify(state)));
                state.anim = "WICKET";
                state.w++;
                if(state.s === 1) state.p1 = {n:n, r:0, b:0};
                else state.p2 = {n:n, r:0, b:0};
                state.b++;
                if(state.b === 6) { state.o++; state.b = 0; state.s = state.s === 1 ? 2 : 1; }
                pushData();
                setTimeout(() => { state.anim = ""; pushData(); }, 3000);
            }
        }

        function newInning() {
            state.target = state.r + 1;
            state.r = 0; state.w = 0; state.o = 0; state.b = 0; state.inn = 2;
            state.p1 = {n:'P1', r:0, b:0}; state.p2 = {n:'P2', r:0, b:0};
            pushData();
        }

        function pushData() {
            state.t1 = document.getElementById('inp-t1').value || state.t1;
            state.tour = document.getElementById('inp-tour').value || state.tour;
            db.set(state);
        }

        function undo() { if(history.length > 0) { state = history.pop(); db.set(state); } }
    </script>
</body>
</html>
