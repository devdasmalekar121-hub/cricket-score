<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chhotu Pro Scorer</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700;900&display=swap');
        
        :root { --primary: #fec309; --dark: #00122e; --accent: #ff0055; }
        body { background: #000; font-family: 'Roboto', sans-serif; color: white; margin: 0; padding-bottom: 70px; overflow-x: hidden; }

        /* --- 1. SCOREBOARD DESIGN (Your Favorite) --- */
        .scoreboard-wrapper { width: 100%; position: relative; }
        .scoreboard { width: 100%; height: 85px; background: linear-gradient(180deg, #00122e 0%, #002b6b 100%); border-bottom: 4px solid var(--primary); display: flex; align-items: center; position: relative; }
        .team-box { width: 120px; background: var(--primary); color: #000; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 22px; font-weight: 900; text-align: center; }
        .score-main { font-size: 45px; font-weight: 900; padding: 0 15px; border-right: 1px solid rgba(255,255,255,0.2); color: var(--primary); }
        .batsman-box { flex-grow: 1; padding-left: 15px; font-size: 15px; }
        .opp-container { width: 240px; height: 100%; display: flex; border-left: 1px solid #fff; }
        .opp-box { background: #d9534f; width: 60%; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 14px; }
        .target-box { background: #b0413e; width: 40%; display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--primary); }

        /* --- 2. BOUNDARY ANIMATION (‡§∂‡§æ‡§®‡§¶‡§æ‡§∞ ‡§™‡§ü‡•ç‡§ü‡•Ä) --- */
        #boundary-anim { position: absolute; top:0; left:0; width:100%; height:100%; display:none; align-items:center; justify-content:center; font-size:50px; font-weight:900; z-index:100; background: var(--primary); color:#000; animation: flash 0.3s infinite; }
        @keyframes flash { 0%, 100% { opacity: 1; } 50% { opacity: 0.8; } }

        /* --- 3. ADMIN CONTROLS (Right below Scoreboard) --- */
        #admin-controls-inline { background: #fff; color: #000; padding: 10px; display: none; border-radius: 0 0 15px 15px; }
        .btn-row { display: flex; gap: 5px; margin-bottom: 8px; flex-wrap: wrap; }
        button { padding: 12px; font-weight: 900; border: none; border-radius: 5px; text-transform: uppercase; cursor: pointer; flex: 1; font-size: 12px; }
        .btn-blue { background: #003a8c; color: white; }
        .btn-yel { background: var(--primary); color: #000; }
        .btn-red { background: var(--accent); color: white; }

        /* --- 4. TABS & PAGES --- */
        .page { display: none; padding: 15px; animation: fadeIn 0.3s; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* NAVIGATION BAR */
        .bottom-nav { position: fixed; bottom: 0; width: 100%; height: 60px; background: #111; display: flex; justify-content: space-around; align-items: center; border-top: 2px solid var(--primary); z-index: 1000; }
        .nav-item { color: #fff; font-size: 11px; opacity: 0.5; text-align: center; font-weight: bold; }
        .nav-item.active { opacity: 1; color: var(--primary); }
        .nav-item i { display: block; font-size: 20px; }

        /* SQUAD & HISTORY STYLES */
        .card { background: #222; padding: 15px; border-radius: 10px; margin-bottom: 10px; border-left: 4px solid var(--primary); }
        input { padding: 10px; border-radius: 5px; border: 1px solid #ccc; width: 90%; margin-bottom: 10px; }
    </style>
</head>
<body>

    <div class="scoreboard-wrapper">
        <div id="boundary-anim">FOUR!</div>
        <div class="scoreboard">
            <div class="team-box" id="d-team">TEAM A</div>
            <div class="score-main"><span id="d-runs">0</span>-<span id="d-wkt">0</span></div>
            <div class="batsman-box">
                <div id="row-b1">‚òÖ <span id="d-b1">PLAYER 1</span> <span id="d-b1r">0</span></div>
                <div id="row-b2">&nbsp;&nbsp;<span id="d-b2">PLAYER 2</span> <span id="d-b2r">0</span></div>
                <div style="font-size:11px; color:var(--primary);">Ov: <span id="d-ov">0.0</span> | <span id="d-tour">TOURNAMENT</span></div>
            </div>
            <div class="opp-container">
                <div class="opp-box">OPP: <span id="d-opp">0-0</span></div>
                <div class="target-box">TGT: <span id="d-target">0</span></div>
            </div>
        </div>

        <div id="admin-controls-inline">
            <div class="btn-row">
                <button class="btn-blue" onclick="addRun(1)">+1</button>
                <button class="btn-blue" onclick="addRun(2)">+2</button>
                <button class="btn-blue" onclick="addRun(3)">+3</button>
                <button class="btn-blue" onclick="addRun(5)">+5</button>
            </div>
            <div class="btn-row">
                <button class="btn-yel" onclick="triggerAnim('FOUR', 4)">FOUR</button>
                <button class="btn-yel" onclick="triggerAnim('SIX', 6)">SIX</button>
                <button class="btn-red" onclick="nextBall('w')">WICKET</button>
                <button class="btn-blue" style="background:green" onclick="nextBall('n')">NEXT BALL</button>
            </div>
            <div class="btn-row">
                <button class="btn-yel" style="background:#e67e22; color:#fff;" onclick="showPage('squad')">üë• 11 PLAYERS NAME</button>
                <button class="btn-red" onclick="logout()">LOCK PANEL</button>
            </div>
        </div>
    </div>

    <div id="page-live" class="page active">
        <div class="card">
            <h3>Match Status</h3>
            <p id="d-status">1ST INNINGS IN PROGRESS</p>
        </div>
    </div>

    <div id="page-squad" class="page">
        <h3>Enter 11 Player Names</h3>
        <div id="player-inputs-list"></div>
    </div>

    <div id="page-history" class="page">
        <h3>Archives</h3>
        <button class="btn-yel" style="width:auto; padding:5px 15px;">2024</button>
        <button class="btn-yel" style="width:auto; padding:5px 15px;">2025</button>
        <div id="hist-list" style="margin-top:20px; opacity:0.5;">No Past Matches Found.</div>
    </div>

    <div id="page-admin" class="page">
        <div id="login-area" style="text-align: center; padding-top: 50px;">
            <h3>Admin Verification</h3>
            <input type="password" id="pass-input" placeholder="Enter Master Password">
            <button onclick="checkPass()" class="btn-yel" style="width:90%">UNLOCK ADMIN</button>
            <p onclick="startOtpProcess()" style="color:var(--primary); font-size:12px; margin-top:20px;">Forgot? Reset via OTP (9399401501)</p>
            <div id="recaptcha-container"></div>
        </div>
        
        <div id="admin-settings" style="display:none; margin-top:20px;">
            <div class="card">
                <h4>Match Info</h4>
                <input type="text" id="i-team" placeholder="Batting Team" oninput="saveData()">
                <input type="text" id="i-tour" placeholder="Tournament" oninput="saveData()">
                <input type="text" id="i-opp" placeholder="Opponent Score" oninput="saveData()">
                <input type="number" id="i-target" placeholder="Target" oninput="saveData()">
                <button class="btn-red" onclick="resetDB()" style="width:100%">FULL RESET MATCH</button>
            </div>
        </div>
    </div>

    <nav class="bottom-nav">
        <div class="nav-item active" onclick="showPage('live', this)"><i>üèè</i>LIVE</div>
        <div class="nav-item" onclick="showPage('squad', this)"><i>üë•</i>SQUAD</div>
        <div class="nav-item" onclick="showPage('history', this)"><i>üìú</i>HISTORY</div>
        <div class="nav-item" onclick="showPage('admin', this)"><i>‚öôÔ∏è</i>ADMIN</div>
    </nav>

    <script>
        const myPass = "ChhotuLive8718";
        const myNum = "+919399401501";
        
        const firebaseConfig = { databaseURL: "Https://myscoreboard-b140f-default-rtdb.firebaseio.com/" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database().ref("pro_v13_master");
        const auth = firebase.auth();

        let st = { r:0, w:0, o:0, b:0, t1:"TEAM A", tour:"TOURNAMENT", opp:"0-0", target:0, strike:1, anim:"", players: Array(11).fill(0).map((_,i)=>({name:"Player "+(i+1), runs:0})) };

        // NAVIGATION
        function showPage(pId, el) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('page-'+pId).classList.add('active');
            if(el) {
                document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
                el.classList.add('active');
            }
        }

        // LOGIN SYSTEM
        function checkPass() {
            if(document.getElementById('pass-input').value === myPass) {
                document.getElementById('admin-controls-inline').style.display = 'block';
                document.getElementById('admin-settings').style.display = 'block';
                document.getElementById('login-area').style.display = 'none';
            } else { alert("Wrong Password!"); }
        }
        function logout() { location.reload(); }

        // OTP RESET
        window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', {size:'invisible'});
        function startOtpProcess() {
            auth.signInWithPhoneNumber(myNum, window.recaptchaVerifier).then(res => {
                let code = prompt("Enter OTP sent to your number:");
                res.confirm(code).then(() => alert("Password is: " + myPass));
            });
        }

        // CORE LOGIC
        function addRun(v) { st.r += v; st.players[st.strike-1].runs += v; saveData(); }
        
        function triggerAnim(txt, runs) {
            st.anim = txt; db.set(st); addRun(runs);
            setTimeout(() => { st.anim = ""; db.set(st); }, 2500);
        }

        function nextBall(type) {
            if(type==='w') st.w++;
            st.b++; if(st.b>=6) { st.o++; st.b=0; }
            saveData();
        }

        function saveData() {
            st.t1 = document.getElementById('i-team').value || st.t1;
            st.tour = document.getElementById('i-tour').value || st.tour;
            st.opp = document.getElementById('i-opp').value || st.opp;
            st.target = document.getElementById('i-target').value || st.target;
            db.set(st);
        }
        
        function resetDB() { if(confirm("Reset Everything?")) db.set(null); location.reload(); }

        // GENERATE PLAYER INPUTS
        const pList = document.getElementById('player-inputs-list');
        for(let i=0; i<11; i++) {
            pList.innerHTML += `P${i+1}: <input type="text" placeholder="Name" oninput="st.players[${i}].name=this.value; saveData()"><br>`;
        }

        // REALTIME SYNC
        db.on("value", (snap) => {
            const data = snap.val(); if(!data) return; st = data;
            document.getElementById('d-runs').innerText = st.r;
            document.getElementById('d-wkt').innerText = st.w;
            document.getElementById('d-ov').innerText = st.o + "." + st.b;
            document.getElementById('d-team').innerText = st.t1;
            document.getElementById('d-tour').innerText = st.tour;
            document.getElementById('d-opp').innerText = st.opp;
            document.getElementById('d-target').innerText = st.target;
            document.getElementById('d-b1').innerText = st.players[0].name;
            document.getElementById('d-b1r').innerText = st.players[0].runs;
            document.getElementById('boundary-anim').style.display = st.anim ? 'flex' : 'none';
            document.getElementById('boundary-anim').innerText = st.anim + "!";
        });
    </script>
</body>
</html>
