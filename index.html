<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chhotu Cricket App</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700;900&display=swap');
        body { background: #000; font-family: 'Roboto', sans-serif; color: white; margin: 0; padding-bottom: 70px; }

        /* HEADER & SCOREBOARD (‡§Ü‡§™‡§ï‡§æ ‡§™‡•Å‡§∞‡§æ‡§®‡§æ ‡§°‡§ø‡§ú‡§æ‡§á‡§®) */
        .scoreboard { width: 100%; height: 85px; background: linear-gradient(180deg, #00122e 0%, #002b6b 100%); border-bottom: 4px solid #fec309; display: flex; align-items: center; position: relative; }
        .team-box { width: 120px; background: #fec309; color: #000; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 22px; font-weight: 900; text-align: center; }
        .score-main { font-size: 45px; font-weight: 900; padding: 0 20px; border-right: 1px solid rgba(255,255,255,0.2); color: #fec309; }
        .batsman-box { flex-grow: 1; padding-left: 15px; font-size: 16px; }
        .striker-active { color: #fec309; font-weight: 900; text-shadow: 0 0 10px rgba(254, 195, 9, 0.5); }
        
        /* OPPONENT & TARGET BOX */
        .opp-container { width: 250px; height: 100%; display: flex; border-left: 2px solid #fff; }
        .opp-score-box { background: #d9534f; width: 60%; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .target-box { background: #b0413e; width: 40%; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #fec309; }

        /* ADMIN BUTTONS (High Professional) */
        #admin-panel { background: #fff; color: #000; padding: 15px; display: none; }
        .admin-row { display: flex; gap: 5px; margin-bottom: 10px; flex-wrap: wrap; }
        button { padding: 12px; font-weight: 900; cursor: pointer; border: none; border-radius: 5px; text-transform: uppercase; font-size: 12px; }
        .btn-run { background: #003a8c; color: white; flex: 1; }
        .btn-boundary { background: #fec309; color: black; flex: 1; }
        .btn-out { background: #d9534f; color: white; flex: 1; }

        /* PLAYER NAME POPUP */
        #player-modal { position: fixed; top: 10%; left: 5%; width: 90%; height: 80%; background: white; color: black; z-index: 3000; display: none; padding: 20px; border-radius: 15px; overflow-y: auto; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .modal-overlay { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:2999; display:none; }

        /* NAVIGATION TABS */
        .bottom-nav { position: fixed; bottom: 0; width: 100%; height: 60px; background: #111; display: flex; justify-content: space-around; align-items: center; border-top: 2px solid #fec309; }
        .nav-item { color: #fff; font-size: 12px; opacity: 0.6; cursor: pointer; }
        .nav-item.active { color: #fec309; opacity: 1; }
        
        #boundary-anim { position: absolute; top:0; left:0; width:100%; height:100%; display:none; align-items:center; justify-content:center; font-size:50px; font-weight:900; z-index:100; background:#fec309; color:#000; }
    </style>
</head>
<body>

    <div id="page-live" style="display: block;">
        <div id="boundary-anim">FOUR!</div>
        <div class="scoreboard">
            <div class="team-box" id="d-team">TEAM A</div>
            <div class="score-main"><span id="d-runs">0</span>-<span id="d-wkt">0</span></div>
            <div class="batsman-box">
                <div id="row-b1">‚òÖ <span id="d-b1">P1</span> <span id="d-b1r">0</span></div>
                <div id="row-b2">&nbsp;&nbsp;<span id="d-b2">P2</span> <span id="d-b2r">0</span></div>
                <div style="font-size:12px; margin-top:5px; opacity:0.8;">Ov: <span id="d-ov">0.0</span> | <span id="d-bowl">BOWLER</span></div>
            </div>
            <div class="opp-container">
                <div class="opp-score-box">
                    <span style="font-size:10px;">OPPONENT</span>
                    <span id="d-opp-score">0-0</span>
                </div>
                <div class="target-box">
                    <span style="font-size:10px;">TARGET</span>
                    <span id="d-target" style="font-size:18px; font-weight:900;">0</span>
                </div>
            </div>
        </div>
        <div style="background:#000; padding:10px; font-size:14px; color:#fec309; font-weight:bold; border-bottom:1px solid #333;">
            <span id="d-tour">TOURNAMENT NAME</span> | <span id="d-inn">1st INNINGS</span>
        </div>
    </div>

    <div id="page-admin" style="display: none; padding: 15px;">
        <div id="login-area" style="text-align: center; padding: 50px 0;">
            <input type="password" id="pass-input" placeholder="Enter Password" style="padding:10px; width:80%; border-radius:5px;"><br><br>
            <button onclick="checkPass()" class="btn-boundary" style="width:85%;">LOGIN</button>
            <p onclick="startOtpProcess()" style="color:#fec309; font-size:12px; margin-top:20px;">Forgot Password? Reset via OTP</p>
            <div id="recaptcha-container"></div>
        </div>

        <div id="admin-panel">
            <h3 style="color:#003a8c; margin-top:0;">Score Control</h3>
            <div class="admin-row">
                <button class="btn-run" onclick="addRun(1)">+1</button>
                <button class="btn-run" onclick="addRun(2)">+2</button>
                <button class="btn-run" onclick="addRun(3)">+3</button>
                <button class="btn-run" onclick="addRun(5)">+5</button>
            </div>
            <div class="admin-row">
                <button class="btn-boundary" onclick="triggerAnim('FOUR', 4)">FOUR</button>
                <button class="btn-boundary" onclick="triggerAnim('SIX', 6)">SIX</button>
                <button class="btn-out" onclick="nextBall('w')">WICKET</button>
                <button class="btn-run" style="background:green" onclick="nextBall('n')">NEXT BALL</button>
            </div>
            <hr>
            <button class="btn-boundary" style="width:100%; background:#e67e22; color:white;" onclick="showPlayerModal()">üìù ENTER 11 PLAYERS NAME</button>
            
            <div class="admin-row" style="margin-top:15px;">
                <input type="text" id="i-team" placeholder="Batting Team" oninput="saveData()" style="width:45%; padding:8px;">
                <input type="text" id="i-opp-score" placeholder="Opp Score (0-0)" oninput="saveData()" style="width:45%; padding:8px;">
            </div>
            <div class="admin-row">
                <input type="text" id="i-tour" placeholder="Tournament" oninput="saveData()" style="width:45%; padding:8px;">
                <input type="number" id="i-target" placeholder="Target" oninput="saveData()" style="width:45%; padding:8px;">
            </div>
            <button onclick="logout()" style="width:100%; margin-top:10px;">LOCK PANEL</button>
        </div>
    </div>

    <div class="modal-overlay" id="overlay"></div>
    <div id="player-modal">
        <h3 style="margin-top:0;">Player List (Batting Team)</h3>
        <div id="player-inputs-grid"></div>
        <button onclick="hidePlayerModal()" class="btn-boundary" style="width:100%; margin-top:15px;">SAVE & CLOSE</button>
    </div>

    <nav class="bottom-nav">
        <div class="nav-item active" id="tab-live" onclick="toggleTab('live')">LIVE SCORE</div>
        <div id="tab-admin" class="nav-item" onclick="toggleTab('admin')">ADMIN</div>
    </nav>

    <script>
        // CONFIG
        const myPass = "ChhotuLive8718";
        const myNumber = "+919399401501";
        
        const firebaseConfig = {
            databaseURL: "Https://myscoreboard-b140f-default-rtdb.firebaseio.com/"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database().ref("pro_v12_final");
        const auth = firebase.auth();

        // INITIAL STATE
        let st = {
            r:0, w:0, b:0, o:0, t1:"TEAM A", tour:"TOURNAMENT", inn:"1st INNINGS",
            oppS:"0-0", target:0, bowl:"BOWLER", strike:1,
            players: Array(11).fill(0).map((_,i)=>({name:"Player "+(i+1), runs:0, balls:0})),
            p1_idx:0, p2_idx:1, anim:""
        };

        // ADMIN ACCESS
        function checkPass() {
            if(document.getElementById('pass-input').value === myPass) {
                document.getElementById('admin-panel').style.display = 'block';
                document.getElementById('login-area').style.display = 'none';
            } else { alert("Wrong Password!"); }
        }

        function logout() {
            document.getElementById('admin-panel').style.display = 'none';
            document.getElementById('login-area').style.display = 'block';
        }

        // OTP SYSTEM
        window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', {'size': 'invisible'});
        function startOtpProcess() {
            auth.signInWithPhoneNumber(myNumber, window.recaptchaVerifier).then(result => {
                window.confirmResult = result;
                let code = prompt("Enter OTP sent to 9399401501:");
                confirmResult.confirm(code).then(() => alert("Your Password is: " + myPass));
            });
        }

        // TABS
        function toggleTab(name) {
            document.getElementById('page-live').style.display = name==='live'?'block':'none';
            document.getElementById('page-admin').style.display = name==='admin'?'block':'none';
            document.getElementById('tab-live').classList.toggle('active', name==='live');
            document.getElementById('tab-admin').classList.toggle('active', name==='admin');
        }

        // PLAYER MODAL
        function showPlayerModal() {
            const grid = document.getElementById('player-inputs-grid');
            grid.innerHTML = "";
            st.players.forEach((p, i) => {
                grid.innerHTML += `<div style="margin-bottom:5px;">P${i+1}: <input type="text" value="${p.name}" oninput="st.players[${i}].name=this.value; saveData()" style="width:70%; padding:5px;"></div>`;
            });
            document.getElementById('player-modal').style.display = 'block';
            document.getElementById('overlay').style.display = 'block';
        }
        function hidePlayerModal() {
            document.getElementById('player-modal').style.display = 'none';
            document.getElementById('overlay').style.display = 'none';
        }

        // LOGIC
        function addRun(v) {
            st.r += v;
            let p = st.strike === 1 ? st.players[st.p1_idx] : st.players[st.p2_idx];
            p.runs += v; saveData();
        }

        function triggerAnim(txt, runs) {
            st.anim = txt; db.set(st); addRun(runs);
            setTimeout(() => { st.anim = ""; db.set(st); }, 2500);
        }

        function nextBall(type) {
            let p = st.strike === 1 ? st.players[st.p1_idx] : st.players[st.p2_idx];
            p.balls++;
            if(type==='w') st.w++;
            st.b++; if(st.b>=6){ st.o++; st.b=0; }
            saveData();
        }

        function saveData() {
            st.t1 = document.getElementById('i-team').value || st.t1;
            st.oppS = document.getElementById('i-opp-score').value || st.oppS;
            st.tour = document.getElementById('i-tour').value || st.tour;
            st.target = document.getElementById('i-target').value || st.target;
            db.set(st);
        }

        // SYNC
        db.on("value", (snap) => {
            st = snap.val() || st;
            document.getElementById('d-runs').innerText = st.r;
            document.getElementById('d-wkt').innerText = st.w;
            document.getElementById('d-ov').innerText = st.o + "." + st.b;
            document.getElementById('d-team').innerText = st.t1;
            document.getElementById('d-opp-score').innerText = st.oppS;
            document.getElementById('d-target').innerText = st.target;
            document.getElementById('d-tour').innerText = st.tour;
            
            document.getElementById('d-b1').innerText = (st.strike===1?"‚òÖ ":"")+st.players[st.p1_idx].name;
            document.getElementById('d-b1r').innerText = st.players[st.p1_idx].runs;
            document.getElementById('d-b2').innerText = (st.strike===2?"‚òÖ ":"")+st.players[st.p2_idx].name;
            document.getElementById('d-b2r').innerText = st.players[st.p2_idx].runs;

            document.getElementById('boundary-anim').style.display = st.anim ? 'flex' : 'none';
            document.getElementById('boundary-anim').innerText = st.anim + "!";
        });
    </script>
</body>
</html>
