<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chhotu Pro Scorer - Master Edition</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700;900&display=swap');
        :root { --primary: #fec309; --dark: #00122e; --accent: #ff0055; }
        body { background: #000; font-family: 'Roboto', sans-serif; color: white; margin: 0; padding-bottom: 90px; overflow-x: hidden; }

        /* --- TOP LIVE EQUATION BAR --- */
        .live-eq-bar { background: #ff0040; color: white; font-size: 13px; padding: 4px 15px; text-align: center; font-weight: 900; text-transform: uppercase; border-bottom: 2px solid #fff; }

        /* --- VS BAR --- */
        .top-vs-bar { background: #000; padding: 5px 15px; display: flex; align-items: center; justify-content: space-between; font-size: 12px; font-weight: 900; }
        .win-progress-bg { width: 100%; height: 8px; background: #333; display: flex; position: relative; overflow: hidden; }
        #win-p1 { width: 50%; background: #004cff; transition: 0.5s; }
        #win-p2 { width: 50%; background: #ff0040; transition: 0.5s; }

        /* --- MAIN SCOREBOARD --- */
        .scoreboard-wrapper { position: relative; width: 100%; box-shadow: 0 10px 30px rgba(0,0,0,0.8); }
        .scoreboard { width: 100%; height: 100px; background: linear-gradient(180deg, #00122e 0%, #002b6b 100%); border-bottom: 4px solid var(--primary); display: flex; align-items: center; position: relative; overflow: hidden; }
        
        .team-box { width: 130px; background: var(--primary); color: #000; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 26px; font-weight: 900; text-align: center; z-index: 10; }
        .score-main { font-size: 55px; font-weight: 900; padding: 0 20px; border-right: 1px solid rgba(255,255,255,0.2); z-index: 10; letter-spacing: -2px; }
        .ov-small { font-size: 18px; opacity: 0.8; font-weight: 400; margin-left: 5px; color: #fff; }
        
        .batsman-box { flex-grow: 1; padding-left: 20px; font-size: 18px; border-right: 1px solid rgba(255,255,255,0.2); height: 80%; display: flex; flex-direction: column; justify-content: center; z-index: 10; }
        .striker { color: var(--primary) !important; font-weight: 900; text-shadow: 0 0 10px rgba(254,195,9,0.8); }
        .batsman-row { color: rgba(255,255,255,0.7); transition: 0.3s; }
        .b-stats { font-size: 14px; opacity: 0.9; margin-left: 10px; color: #fff; }

        .opp-container { width: 280px; height: 100%; display: flex; z-index: 10; }
        .opp-box { background: #d9534f; width: 60%; display: flex; flex-direction: column; align-items: center; justify-content: center; border-right: 1px solid #fff; }
        .target-box { background: #b0413e; width: 40%; display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--primary); }

        /* --- BOUNDARY ANIMATION --- */
        #boundary-anim { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: none; align-items: center; justify-content: center; font-size: 75px; font-weight: 900; z-index: 100; background: var(--primary); color: #000; animation: flash 0.3s infinite; }
        @keyframes flash { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }

        /* --- TOURNAMENT & INNINGS STRIP --- */
        .bottom-strip { background: #000; padding: 8px 15px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid #333; }
        .tour-info { display: flex; align-items: center; gap: 15px; }
        #d-tour { font-size: 18px; font-weight: 900; color: var(--primary); text-transform: uppercase; }
        .inn-tag { background: #333; padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 900; color: #00ff00; }
        .crr-tag { color: #fff; font-size: 12px; font-weight: 900; }

        .over-dots { display: flex; gap: 5px; }
        .dot { width: 22px; height: 22px; border-radius: 50%; background: #222; border: 1px solid #444; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: 900; }
        .dot.active { background: var(--primary); color: #000; border-color: #fff; }

        /* --- NAVIGATION --- */
        .bottom-nav { position: fixed; bottom: 0; width: 100%; height: 75px; background: #111; display: flex; justify-content: space-around; align-items: center; border-top: 3px solid var(--primary); z-index: 1000; }
        .nav-item { color: #fff; font-size: 11px; opacity: 0.5; text-align: center; font-weight: 900; flex: 1; }
        .nav-item.active { opacity: 1; color: var(--primary); }
        .nav-item span { display: block; font-size: 22px; margin-bottom: 2px; }

        /* --- PAGES --- */
        .page { display: none; padding: 15px; padding-bottom: 100px; }
        .page.active { display: block; }

        /* --- ADMIN PANEL ELEMENTS --- */
        .admin-card { background: #1a1a1a; padding: 15px; border-radius: 12px; margin-bottom: 15px; border: 1px solid #333; }
        .btn-row { display: flex; gap: 8px; margin-bottom: 10px; }
        button { padding: 12px; font-weight: 900; border: none; border-radius: 6px; cursor: pointer; flex: 1; font-size: 12px; text-transform: uppercase; }
        .btn-blue { background: #004cff; color: white; }
        .btn-yel { background: var(--primary); color: #000; }
        .btn-red { background: #ff0040; color: white; }
        .btn-green { background: #28a745; color: white; }
        input { width: 95%; padding: 12px; margin-bottom: 10px; background: #000; border: 1px solid #444; color: #fff; border-radius: 6px; }
        label { display: block; font-size: 10px; color: #888; margin-bottom: 5px; font-weight: 900; }
    </style>
</head>
<body onload="startClock(); setupHistoryYears();">

    <div class="live-eq-bar" id="d-equation">WELCOME TO LIVE STREAM</div>

    <div class="top-vs-bar">
        <span id="txt-t1">TEAM A</span>
        <div style="flex-grow: 1; margin: 0 15px;">
            <div class="win-progress-bg">
                <div id="win-p1"></div>
                <div id="win-p2"></div>
            </div>
        </div>
        <span id="txt-t2">TEAM B</span>
    </div>

    <div class="scoreboard-wrapper">
        <div id="boundary-anim">FOUR!</div>
        <div class="scoreboard">
            <div class="team-box" id="d-team">TEAM A</div>
            <div class="score-main">
                <span id="d-runs">0</span>-<span id="d-wkt">0</span><span class="ov-small">(<span id="d-ov">0.0</span>)</span>
            </div>
            
            <div class="batsman-box">
                <div id="row-b1" class="batsman-row"><span id="d-b1-s"></span> <span id="d-b1">BATSMAN 1</span> <span class="b-stats" id="d-b1-r">0(0)</span></div>
                <div id="row-b2" class="batsman-row"><span id="d-b2-s"></span> <span id="d-b2">BATSMAN 2</span> <span class="b-stats" id="d-b2-r">0(0)</span></div>
            </div>

            <div class="opp-container">
                <div class="opp-box">
                    <span style="font-size: 9px; font-weight: 900; opacity: 0.8;">OPPONENT</span>
                    <span style="font-size: 20px; font-weight: 900;" id="d-opp-score">0-0 (0.0)</span>
                </div>
                <div class="target-box">
                    <span style="font-size: 9px; font-weight: 900;">TARGET</span>
                    <span style="font-size: 24px; font-weight: 900;" id="d-target">0</span>
                </div>
            </div>
        </div>

        <div class="bottom-strip">
            <div class="tour-info">
                <span id="d-tour">TOURNAMENT NAME</span>
                <span class="inn-tag" id="d-inn-status">1ST INNINGS</span>
                <span class="crr-tag">CRR: <span id="d-crr">0.00</span></span>
            </div>
            <div style="display: flex; align-items: center; gap: 15px;">
                <span style="font-size: 12px; font-weight: 900; color: #fff;" id="d-bowl">BOWLER</span>
                <div class="over-dots" id="dots-container">
                    <div class="dot">1</div><div class="dot">2</div><div class="dot">3</div><div class="dot">4</div><div class="dot">5</div><div class="dot">6</div>
                </div>
            </div>
        </div>
    </div>

    <div id="page-live" class="page active">
        <div class="admin-card">
            <h4 style="margin:0 0 10px 0; color:var(--primary);">MATCH CENTER</h4>
            <p style="font-size: 13px; opacity:0.8;">Live match data is being synced with Firebase.</p>
            <div style="display: flex; justify-content: space-between; border-top: 1px solid #333; pt:10px;">
                <span id="live-time-date">DATE: 10-JAN-2026</span>
                <span id="live-clock">00:00:00 AM</span>
            </div>
        </div>
    </div>

    <div id="page-history" class="page">
        <h3>Archives</h3>
        <div id="year-buttons-container" style="display: flex; gap: 10px;"></div>
    </div>

    <div id="page-squad" class="page">
        <h3>Playing XI</h3>
        <div id="player-list-display">No players added yet.</div>
    </div>

    <div id="page-admin" class="page">
        <div id="login-area" style="text-align: center; padding: 30px 0;">
            <input type="password" id="pass-input" placeholder="Admin Password">
            <button onclick="checkPass()" class="btn-yel" style="width:100%; margin-top:10px;">LOGIN</button>
        </div>

        <div id="admin-panel" style="display:none;">
            <div class="admin-card">
                <label>RUNS & WICKETS</label>
                <div class="btn-row">
                    <button class="btn-blue" onclick="addRun(1)">+1</button>
                    <button class="btn-blue" onclick="addRun(2)">+2</button>
                    <button class="btn-blue" onclick="addRun(3)">+3</button>
                    <button class="btn-red" onclick="addRun(-1)">-1</button>
                </div>
                <div class="btn-row">
                    <button class="btn-yel" onclick="triggerAnim('FOUR', 4)">FOUR</button>
                    <button class="btn-yel" onclick="triggerAnim('SIX', 6)">SIX</button>
                    <button class="btn-red" onclick="nextBall('w')">WICKET</button>
                    <button class="btn-green" onclick="nextBall('n')">NEXT BALL</button>
                </div>
                <div class="btn-row">
                    <button class="btn-yel" style="background:#e67e22; color:#fff;" onclick="changeStrike()">üîÑ SWAP STRIKE</button>
                </div>
            </div>

            <div class="admin-card">
                <label>BATSMEN NAMES</label>
                <input type="text" id="i-b1" placeholder="Batsman 1 Name" oninput="saveData()">
                <input type="text" id="i-b2" placeholder="Batsman 2 Name" oninput="saveData()">
                <label>BOWLER NAME</label>
                <input type="text" id="i-bowl" placeholder="Current Bowler" oninput="saveData()">
            </div>

            <div class="admin-card">
                <label>TEAM CONFIG</label>
                <input type="text" id="i-team" placeholder="Batting Team Name" oninput="saveData()">
                <input type="text" id="i-opp-name" placeholder="Opponent Team Name" oninput="saveData()">
                <input type="text" id="i-opp-score" placeholder="Opponent Full Score (Ex: 145-6 20.0)" oninput="saveData()">
                <input type="number" id="i-target" placeholder="Match Target" oninput="saveData()">
                <input type="text" id="i-tour" placeholder="Tournament Name" oninput="saveData()">
                <button class="btn-red" onclick="resetDB()" style="width:100%;">RESET ALL DATA</button>
            </div>
        </div>
    </div>

    <nav class="bottom-nav">
        <div class="nav-item active" onclick="showPage('live', this)"><span>üèè</span>LIVE</div>
        <div class="nav-item" onclick="showPage('history', this)"><span>üìú</span>HISTORY</div>
        <div class="nav-item" onclick="showPage('squad', this)"><span>üë•</span>SQUAD</div>
        <div class="nav-item" onclick="showPage('admin', this)"><span>‚öôÔ∏è</span>ADMIN</div>
    </nav>

    <script>
        const myPass = "ChhotuLive8718";
        const firebaseConfig = { databaseURL: "Https://myscoreboard-b140f-default-rtdb.firebaseio.com/" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database().ref("pro_v20_master");

        let st = { 
            r:0, w:0, o:0, b:0, t1:"TEAM A", t2:"TEAM B", tour:"TOURNAMENT", 
            oppS:"0-0 (0.0)", target:0, strike:1, bowl:"BOWLER", 
            p1:{name:"BATSMAN 1", r:0, b:0}, p2:{name:"BATSMAN 2", r:0, b:0}, 
            anim:"", inn: "1ST INNINGS"
        };

        // --- UTILS ---
        function startClock() {
            setInterval(() => {
                const now = new Date();
                document.getElementById('live-clock').innerText = now.toLocaleTimeString();
                document.getElementById('live-time-date').innerText = "DATE: " + now.toLocaleDateString().toUpperCase();
            }, 1000);
        }

        function setupHistoryYears() {
            const container = document.getElementById('year-buttons-container');
            const currentYear = new Date().getFullYear();
            for (let i = currentYear - 2; i <= currentYear; i++) {
                let btn = document.createElement('button');
                btn.innerText = i; btn.className = "btn-blue";
                btn.onclick = () => alert("Year " + i + " Archives Empty.");
                container.appendChild(btn);
            }
        }

        function showPage(p, el) {
            document.querySelectorAll('.page').forEach(pg => pg.classList.remove('active'));
            document.getElementById('page-'+p).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            el.classList.add('active');
        }

        function checkPass() {
            if(document.getElementById('pass-input').value === myPass) {
                document.getElementById('admin-panel').style.display = 'block';
                document.getElementById('login-area').style.display = 'none';
            } else alert("Wrong Password!");
        }

        // --- CORE LOGIC ---
        function addRun(v) {
            st.r += v;
            if(st.strike === 1) st.p1.r += v; else st.p2.r += v;
            saveData();
        }

        function nextBall(type) {
            if(type === 'w') st.w++;
            if(st.strike === 1) st.p1.b++; else st.p2.b++;
            st.b++; if(st.b >= 6) { st.o++; st.b = 0; }
            saveData();
        }

        function changeStrike() { st.strike = st.strike === 1 ? 2 : 1; saveData(); }

        function triggerAnim(txt, runs) {
            st.anim = txt; db.set(st); addRun(runs);
            setTimeout(() => { st.anim = ""; db.set(st); }, 2500);
        }

        function saveData() {
            // Update names from inputs if they exist
            if(document.getElementById('i-b1')) {
                st.p1.name = document.getElementById('i-b1').value || st.p1.name;
                st.p2.name = document.getElementById('i-b2').value || st.p2.name;
                st.t1 = document.getElementById('i-team').value || st.t1;
                st.t2 = document.getElementById('i-opp-name').value || st.t2;
                st.oppS = document.getElementById('i-opp-score').value || st.oppS;
                st.target = document.getElementById('i-target').value || st.target;
                st.tour = document.getElementById('i-tour').value || st.tour;
                st.bowl = document.getElementById('i-bowl').value || st.bowl;
            }
            db.set(st);
        }

        function resetDB() { if(confirm("Clear Match Data?")) { db.set(null); location.reload(); } }

        // --- DATA SYNC ---
        db.on("value", snap => {
            const data = snap.val(); if(!data) return; st = data;
            
            // Score
            document.getElementById('d-runs').innerText = st.r;
            document.getElementById('d-wkt').innerText = st.w;
            document.getElementById('d-ov').innerText = st.o + "." + st.b;
            
            // Teams & Info
            document.getElementById('d-team').innerText = st.t1;
            document.getElementById('txt-t1').innerText = st.t1;
            document.getElementById('txt-t2').innerText = st.t2;
            document.getElementById('d-opp-score').innerText = st.oppS;
            document.getElementById('d-target').innerText = st.target;
            document.getElementById('d-tour').innerText = st.tour;
            document.getElementById('d-bowl').innerText = st.bowl;

            // Batsmen Strike Logic
            document.getElementById('d-b1').innerText = st.p1.name;
            document.getElementById('d-b1-r').innerText = `${st.p1.r}(${st.p1.b})`;
            document.getElementById('d-b2').innerText = st.p2.name;
            document.getElementById('d-b2-r').innerText = `${st.p2.r}(${st.p2.b})`;
            
            document.getElementById('d-b1-s').innerText = st.strike===1 ? "‚òÖ" : "";
            document.getElementById('row-b1').className = st.strike===1 ? "batsman-row striker" : "batsman-row";
            document.getElementById('d-b2-s').innerText = st.strike===2 ? "‚òÖ" : "";
            document.getElementById('row-b2').className = st.strike===2 ? "batsman-row striker" : "batsman-row";

            // Live Equation & CRR
            let totalBalls = (st.o * 6) + st.b;
            let totalOv = totalBalls / 6;
            let crr = totalOv > 0 ? (st.r / totalOv).toFixed(2) : "0.00";
            document.getElementById('d-crr').innerText = crr;

            if(st.target > 0) {
                let runsNeeded = st.target - st.r;
                let ballsLeft = 120 - totalBalls; // Assuming 20 Overs
                if(runsNeeded <= 0) document.getElementById('d-equation').innerText = st.t1 + " WON THE MATCH!";
                else document.getElementById('d-equation').innerText = `${st.t1} NEEDS ${runsNeeded} RUNS IN ${ballsLeft} BALLS`;
                document.getElementById('d-inn-status').innerText = "2ND INNINGS";
            } else {
                document.getElementById('d-equation').innerText = "1ST INNINGS IN PROGRESS";
                document.getElementById('d-inn-status').innerText = "1ST INNINGS";
            }

            // Dots & Anim
            let dots = document.querySelectorAll('.dot');
            dots.forEach((d, i) => d.className = i < st.b ? "dot active" : "dot");
            document.getElementById('boundary-anim').style.display = st.anim ? 'flex' : 'none';
            document.getElementById('boundary-anim').innerText = st.anim + "!";
        });
    </script>
</body>
</html>
